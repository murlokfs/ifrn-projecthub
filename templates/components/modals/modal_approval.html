<div id="evaluationModal" class="modal-overlay" style="display: none;">
    <div class="modal-container">
        
        <div class="modal-header">
            <div class="header-texts">
                <h2>Avaliar Projeto</h2>
                <p>Revise o projeto e forneça seu feedback ao aluno</p>
            </div>
            <button class="btn-close" onclick="closeModal()">
                <i class="ph ph-x"></i>
            </button>
        </div>

        <div class="modal-body">
            
            <div class="project-summary-box">
                <h3>Project Hub - Armazene seus projetos e trabalhos</h3>
                <div class="subtitle-row">
                    <i class="ph-fill ph-graduation-cap"></i>
                    <span>Academic Hub — A Plataforma de Projetos Acadêmicos do Futuro.</span>
                </div>
                <div class="tags-row mini-tags">
                    <span class="tag">NOSQL</span>
                    <span class="tag">NOSQL</span>
                    <span class="tag">NOSQL</span>
                </div>
            </div>

            <div class="form-section">
                <label class="section-label">
                    <i class="ph ph-warning-circle"></i> Decisão *
                </label>

                <div class="decision-options">
                    <input type="radio" name="decision" id="opt-approve" value="approve" class="hidden-radio">
                    <label for="opt-approve" class="option-card option-approve">
                        <div class="radio-circle">
                            <div class="radio-dot"></div>
                        </div>
                        <div class="option-icon-box success">
                            <i class="ph ph-check"></i>
                        </div>
                        <div class="option-texts">
                            <strong>Aprovar Projeto</strong>
                            <span>O projeto será publicado na plataforma</span>
                        </div>
                    </label>

                    <input type="radio" name="decision" id="opt-reject" value="reject" class="hidden-radio">
                    <label for="opt-reject" class="option-card option-reject">
                        <div class="radio-circle">
                            <div class="radio-dot"></div>
                        </div>
                        <div class="option-icon-box danger">
                            <i class="ph ph-x"></i>
                        </div>
                        <div class="option-texts">
                            <strong>Reprovar Projeto</strong>
                            <span>O projeto não será publicado</span>
                        </div>
                    </label>
                </div>
            </div>

            <div class="form-section">
                <label class="section-label">
                    <i class="ph ph-warning-circle"></i> Feedback para o aluno *
                </label>
                <textarea class="feedback-input" placeholder="Explique os pontos positivos do projeto e forneça sugestões de melhoria..."></textarea>
                <p class="helper-text">O aluno poderá visualizar este feedback no card do projeto</p>
            </div>

        </div>

        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeModal()">Cancelar</button>
            <button class="btn-primary" onclick="submitEvaluation()">Confirmar avaliação</button>
        </div>

    </div>
</div>

<script>
    // Função para abrir o modal e limpar erros visuais
    function openModal() {
        const input = document.querySelector('.feedback-input');
        if(input) input.classList.remove('input-error');
        
        // Limpa a seleção dos radios ao abrir (opcional)
        const radios = document.querySelectorAll('input[name="decision"]');
        radios.forEach(r => r.checked = false);
        
        // Limpa o texto
        if(input) input.value = '';

        document.getElementById('evaluationModal').style.display = 'flex';
    }

    // Função para fechar o modal
    function closeModal() {
        document.getElementById('evaluationModal').style.display = 'none';
    }

    // Função de Validação e Envio
    function submitEvaluation() {
        const feedbackInput = document.querySelector('.feedback-input');
        const decisionInputs = document.querySelectorAll('input[name="decision"]');
        
        let decisionSelected = false;
        
        // Verifica radio selecionado
        decisionInputs.forEach(input => {
            if (input.checked) decisionSelected = true;
        });

        const feedbackText = feedbackInput.value.trim();

        // Validação
        if (!decisionSelected) {
            alert("Por favor, selecione uma decisão (Aprovar ou Reprovar).");
            return;
        }

        if (feedbackText === "") {
            alert("O campo de feedback é obrigatório.");
            feedbackInput.classList.add('input-error');
            feedbackInput.focus();
            return;
        }

        // Sucesso (Aqui entraria o código Django/Fetch real no futuro)
        console.log("Enviando avaliação...");
        alert("Avaliação registrada com sucesso!");
        closeModal();
    }

    // Remove borda vermelha ao digitar
    document.addEventListener("DOMContentLoaded", () => {
        const feedbackInput = document.querySelector('.feedback-input');
        if(feedbackInput){
            feedbackInput.addEventListener('input', function() {
                if(this.value.trim() !== "") {
                    this.classList.remove('input-error');
                }
            });
        }
    });
</script>