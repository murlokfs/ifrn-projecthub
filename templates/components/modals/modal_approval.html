<div id="evaluationModal" class="modal-overlay" style="display: none;">
        <div class="modal-container">

            <div class="modal-header">
                <div class="header-texts">
                    <h2>Avaliar Projeto</h2>
                    <p>Revise o projeto e forneça seu feedback ao aluno</p>
                </div>
                <button class="btn-close" onclick="closeModal()">
                    <i class="ph ph-x"></i>
                </button>
            </div>

            <div class="modal-body">

                <div class="project-summary-box">
                    <h3>Project Hub - Armazene seus projetos</h3>
                    <div class="subtitle-row">
                        <i class="ph-fill ph-graduation-cap"></i>
                        <span>Academic Hub — Plataforma de Projetos</span>
                    </div>
                    <div class="tags-row mini-tags">
                        <span class="tag">NOSQL</span>
                        <span class="tag">NOSQL</span>
                        <span class="tag">NOSQL</span>
                    </div>
                </div>

                <div class="form-section">
                    <label class="section-label">
                        <i class="ph ph-warning-circle"></i> Decisão *
                    </label>

                    <div class="decision-options">
                        <input type="radio" name="decision" id="opt-approve" value="approve" class="hidden-radio">
                        <label for="opt-approve" class="option-card option-approve">
                            <div class="radio-circle">
                                <div class="radio-dot"></div>
                            </div>
                            <div class="option-icon-box success"><i class="ph ph-check"></i></div>
                            <div class="option-texts">
                                <strong>Aprovar Projeto</strong>
                                <span>O projeto será publicado na plataforma</span>
                            </div>
                        </label>

                        <input type="radio" name="decision" id="opt-reject" value="reject" class="hidden-radio">
                        <label for="opt-reject" class="option-card option-reject">
                            <div class="radio-circle">
                                <div class="radio-dot"></div>
                            </div>
                            <div class="option-icon-box danger"><i class="ph ph-x"></i></div>
                            <div class="option-texts">
                                <strong>Reprovar Projeto</strong>
                                <span>O projeto não será publicado</span>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="form-section">
                    <label class="section-label">
                        <i class="ph ph-warning-circle"></i> Feedback para o aluno *
                    </label>
                    <textarea class="feedback-input"
                        placeholder="Explique os pontos positivos e melhorias..."></textarea>
                    <p class="helper-text">O aluno poderá visualizar este feedback</p>
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeModal()">Cancelar</button>
                <button class="btn-primary" onclick="submitEvaluation()">Confirmar avaliação</button>
            </div>

        </div>
    </div>

<script>
    // --- FUNÇÕES GLOBAIS (Acessíveis pelo HTML) ---

    // ==========================
    // 1. MODAL DE AVALIAÇÃO
    // ==========================
    function openModal() {
        const input = document.querySelector('.feedback-input');
        if (input) input.classList.remove('input-error');

        // Limpa a seleção dos radios
        const radios = document.querySelectorAll('input[name="decision"]');
        radios.forEach(r => r.checked = false);

        // Limpa o texto
        if (input) input.value = '';

        const modal = document.getElementById('evaluationModal');
        if(modal) modal.style.display = 'flex';
    }

    function closeModal() {
        const modal = document.getElementById('evaluationModal');
        if(modal) modal.style.display = 'none';
    }

    function submitEvaluation() {
        const feedbackInput = document.querySelector('.feedback-input');
        const decisionInputs = document.querySelectorAll('input[name="decision"]');

        let decisionSelected = false;

        // Verifica radio selecionado
        decisionInputs.forEach(input => {
            if (input.checked) decisionSelected = true;
        });

        const feedbackText = feedbackInput.value.trim();

        // Validação
        if (!decisionSelected) {
            alert("Por favor, selecione uma decisão (Aprovar ou Reprovar).");
            return;
        }

        if (feedbackText === "") {
            alert("O campo de feedback é obrigatório.");
            feedbackInput.classList.add('input-error');
            feedbackInput.focus();
            return;
        }

        // Sucesso
        console.log("Enviando avaliação...");
        // AQUI VOCÊ DEVE ADICIONAR A LÓGICA DE ENVIO DO FEEDBACK PARA O DJANGO DEPOIS
        alert("Avaliação registrada com sucesso!");
        closeModal();
    }


    // ==========================
    // 2. MODAL DE EXCLUSÃO (Lógica do Django integrada)
    // ==========================
    
    // Variável global para guardar o ID do projeto que será deletado
    let projectToDeleteId = null; 

    // Agora recebe projectId E projectName
    function openDeleteModal(projectId, projectName) {
        // Compatibilidade: se apenas um argumento (nome) for passado
        if (projectName === undefined && typeof projectId === 'string') {
            projectName = projectId;
            projectId = null;
        }

        // 1. Guarda o ID (se houver)
        projectToDeleteId = projectId;

        // 2. Atualiza o texto em negrito com o nome do projeto clicado
        const nameElement = document.getElementById('deleteProjectName');
        if (nameElement) {
            nameElement.innerText = `"${projectName || 'Nome do Projeto'}"`;
        }
        
        // 3. Exibe o modal
        const modal = document.getElementById('deleteModal');
        if (modal) {
            modal.style.display = 'flex';
        }
    }

    function closeDeleteModal() {
        const modal = document.getElementById('deleteModal');
        if (modal) {
            modal.style.display = 'none';
        }
        projectToDeleteId = null; // Limpa a variável por segurança
    }

    function confirmDelete() {
        if (projectToDeleteId) {
            // REDIRECIONA PARA A URL DE DELETAR DO DJANGO
            window.location.href = `/projetos/deletar/${projectToDeleteId}/`;
        } else {
            console.error("Erro: Nenhum ID de projeto encontrado para exclusão.");
            closeDeleteModal();
        }
    }


    // --- EVENTOS DE CARREGAMENTO & FECHAMENTO GERAL ---
    document.addEventListener("DOMContentLoaded", () => {
        
        // Remove borda vermelha ao digitar no feedback
        const feedbackInput = document.querySelector('.feedback-input');
        if (feedbackInput) {
            feedbackInput.addEventListener('input', function () {
                if (this.value.trim() !== "") {
                    this.classList.remove('input-error');
                }
            });
        }
    });

    // Fecha os modais se clicar fora deles (Overlay)
    window.onclick = function(event) {
        const modalDelete = document.getElementById('deleteModal');
        const modalEval = document.getElementById('evaluationModal');

        if (event.target == modalDelete) {
            closeDeleteModal();
        }
        if (event.target == modalEval) {
            closeModal();
        }
    }
</script>

    <div id="deleteModal" class="modal-overlay" style="display: none;">
        <div class="modal-container delete-theme">
            <div class="modal-body delete-body">
                <div class="delete-header">
                    <i class="ph ph-warning"></i>
                    <h2>Excluir Projeto por Violação</h2>
                </div>

                <p class="delete-desc">
                    Você está prestes a excluir permanentemente o projeto <strong id="deleteProjectName">"Nome do
                        Projeto"</strong> por violar diretrizes éticas ou direitos humanos.
                </p>

                <p class="delete-warning">
                    Esta ação é irreversível e o aluno será notificado sobre a exclusão e o motivo.
                </p>
            </div>

            <div class="modal-footer delete-footer">
                <button class="btn-secondary" onclick="closeDeleteModal()">Cancelar</button>
                <button class="btn-danger" onclick="confirmDelete()">Confirmar Exclusão</button>
            </div>

        </div>
    </div>